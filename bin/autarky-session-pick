#!/bin/zsh

# Ensure each exists and gettem
pre_sessions=(cururo monito-del-monte pudu)
for s in "${pre_sessions[@]}"; do
  tmux has-session -t "$s" 2>/dev/null || tmux new-session -d -s "$s"
done
sessions=($(tmux list-sessions -F '#S'))

# Print menu
echo "Select a tmux session to attach to by pressing its number:"
for ((i=1; i<=${#sessions[@]}; i++)); do
  printf "%d) %s\n" "$i" "${sessions[i]}"
done
echo "q) Quit"

# Wait for a single key press
while true; do
  read -rk1 key
  if [[ "$key" == "q" ]]; then
    break
  elif [[ "$key" =~ [1-9] ]]; then
    idx=$key
    if (( idx <= ${#sessions[@]} )); then
      tmux attach -t "${sessions[idx]}"
      break
    fi
  fi
done

